%%{init: {'theme':'base','themeVariables':{ 'primaryColor':'#ff8b00','edgeLabelBackground':'#ffffff','tertiaryColor':'#fef3c7'}}}%%

stateDiagram-v2
title: SM-03.02 — Appeal / Dispute Flow (C2-03 Governance & DAO)

[*] --> OPENED : AppealOpened (DDD EVT 36)
note right of OPENED
  Appeal registered with context:
  • origin (proposalId / executionId)
  • appellant identity & grounds
end note

OPENED --> INTAKE : IntakeStarted
note right of INTAKE
  Formal checks:
  • timeliness, standing, scope
  • link to decision/execution record
end note

INTAKE --> UNDER_REVIEW : EligibilityConfirmed
INTAKE --> REJECTED : Ineligible

UNDER_REVIEW --> EVIDENCE : EvidenceRequested
EVIDENCE --> HEARING : EvidenceSubmitted
UNDER_REVIEW --> HEARING : HearingScheduled

HEARING --> DECISION : DeliberationClosed
note right of DECISION
  Panel evaluates facts, policy, ethics
  Options:
  • Uphold previous decision
  • Overturn / Modify (remedy)
  • Require re-vote / re-execution
end note

DECISION --> CLOSED : Outcome → Uphold (DDD EVT 38)
DECISION --> REMEDY_APPLIED : Outcome → Overturn / Modify (DDD EVT 38)
DECISION --> GOV_REEXEC : Outcome → Re-vote / Re-execution (DDD EVT 38)

REMedy_APPLIED: REMEDY_APPLIED
REMedy_APPLIED --> CLOSED : RemedyExecuted (DDD EVT 39)

GOV_REEXEC --> CLOSED : ReExecutionLogged (DDD EVT 40)

REJECTED --> CLOSED : AppealClosed

CLOSED --> [*]

%% ===== Styling =====
classDef core fill:#ff8b00,stroke:#333,color:#fff,font-weight:bold;
class OPENED,INTAKE,UNDER_REVIEW,EVIDENCE,HEARING,DECISION,REMEDY_APPLIED,GOV_REEXEC,REJECTED,CLOSED core;