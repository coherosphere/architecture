%%{init: {'theme':'base','themeVariables':{ 'fontFamily':'Inter,Arial', 'primaryColor':'#ff8b00','lineColor':'#334155'}}}%%
flowchart LR
%%{init: {'theme':'base','themeVariables':{ 'fontFamily':'Inter,Arial', 'primaryColor':'#ff8b00','lineColor':'#334155'}}}%%
flowchart LR
  %% --- Coherosphere CI Theme ---
  classDef container fill:#111827,stroke:#111827,color:#ffffff,font-weight:bold;
  classDef compute fill:#ff8b00,stroke:#333333,color:#ffffff;
  classDef control fill:#fde68a,stroke:#b45309,color:#1f2937;
  classDef worker fill:#fb923c,stroke:#7c2d12,color:#1f2937;
  classDef store fill:#0ea5e9,stroke:#075985,color:#ffffff;
  classDef event fill:#22c55e,stroke:#065f46,color:#083344;
  classDef risk fill:#ef4444,stroke:#7f1d1d,color:#ffffff;
  classDef ext fill:#e5e7eb,stroke:#9ca3af,color:#111827;
  classDef ui fill:#8b5cf6,stroke:#4c1d95,color:#ffffff;
  linkStyle default stroke:#334155,stroke-width:2px;

  %% ===== Container & Components (C2-05 â†’ C3-05.xx) =====
  subgraph ID["C2-05 Identity & Reputation Service (PoCI)"]
    class ID container
    DIDM["C3-05.01 DID Manager"]:::control
    ISS["C3-05.02 Credential Issuer (VC / SBT)"]:::control
    REPG["C3-05.03 Reputation Graph"]:::compute
    SYB["C3-05.04 Sybil Resistance Evaluator"]:::risk
    VER["C3-05.05 Verifier / Attestation Checker"]:::control
    ATTEST["C3-05.06 Attestation Registry"]:::store
    PDB["C3-05.07 PoCI Data Store"]:::store
    PUB["C3-05.08 Reputation Event Publisher"]:::event
  end

  %% ===== Internal flows =====
  DIDM --> ISS --> REPG --> PUB
  SYB --> REPG
  VER --> ATTEST
  ISS --> ATTEST
  REPG --> PDB
  ATTEST --> PDB

  %% ===== External context =====
  UI["C2-12 Resonance Board / UI"]:::ui --> VER
  ETH["C2-08 Manifesto & Ethics Guard"]:::ext --> ISS
  GOV["C2-03 Governance Service"]:::ext --> VER
  POC["C2-02 PoC Service"]:::ext --> VER
  PUB --> MET["C2-07 Metrics / Analytics"]:::ext
  SEC["C2-10 Security & Audit Layer"]:::ext --> SYB
  REPG --> ETH
