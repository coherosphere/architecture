%%{init: {'theme':'base','themeVariables':{ 'fontFamily':'Inter,Arial', 'primaryColor':'#ff8b00','lineColor':'#334155'}}}%%
stateDiagram-v2
%%{init: {'theme':'base','themeVariables':{ 'fontFamily':'Inter,Arial', 'primaryColor':'#ff8b00','lineColor':'#334155'}}}%%
stateDiagram-v2
%%{init: {'theme':'base','themeVariables':{ 'primaryColor':'#ff8b00','edgeLabelBackground':'#ffffff','tertiaryColor':'#fef3c7'}}}%%
stateDiagram-v2
title: SM-06.02 - Project Lifecycle (C2-06 Local Hub / Federation)

[*] --> PLANNED : ProjectCreated (DDD EVT 62)
note right of PLANNED
  Project registered in local hub context  
  · proposal approved via Governance (C2-03)  
  · hub assigns steward and metadata  
  · initial budget & milestones defined
end note

PLANNED --> ACTIVE : MilestoneStarted
note right of ACTIVE
  Work phase begins  
  · contributions logged in PoC (C2-02)  
  · funding stream initiated via Treasury (C2-04)  
  · progress tracked in Metrics (C2-07)
end note

ACTIVE --> REVIEW : MilestoneReported (DDD EVT 63)
note right of REVIEW
  Evaluate milestone completion:  
  · quantitative (metrics, deliverables)  
  · qualitative (alignment, resonance)  
  · peer validation or ethics guard review
end note

REVIEW --> APPROVED : MilestoneApproved (DDD EVT 64)
REVIEW --> REJECTED : MilestoneRejected
REJECTED --> ACTIVE : ReworkSubmitted
APPROVED --> NEXT_PHASE : NextMilestonePlanned
NEXT_PHASE --> ACTIVE : PhaseStarted

APPROVED --> COMPLETED : AllMilestonesDone (DDD EVT 65)
note right of COMPLETED
  Project closed successfully  
  · Treasury marks payout complete  
  · final SRI contribution logged
end note

COMPLETED --> [*]

%% ---- Exceptional paths ----
ACTIVE --> PAUSED : ResourceShortage / GovernanceHold
PAUSED --> ACTIVE : ResumeAuthorized
PAUSED --> CANCELLED : CancelledByGovernance
CANCELLED --> [*] : ProjectTerminated (DDD EVT 66)

%% ---- Maintenance / metrics sync ----
ACTIVE --> SYNC : SyncToFederation
SYNC --> ACTIVE : SyncComplete

%% ===== Styling =====
classDef core fill:#ff8b00,stroke:#333,color:#fff,font-weight:bold;
class PLANNED,ACTIVE,REVIEW,APPROVED,NEXT_PHASE,COMPLETED,PAUSED,CANCELLED,REJECTED,SYNC core;
